<!DOCTYPE html>
<html lang="fr">
<head>
  <link rel="preload" as="image" href="https://i.imgur.com/2y2kmUp.png">
  <meta charset="UTF-8">
  <title>Quiz à Réponses Multiples</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Couleur pour Android (Chrome) -->
  <meta name="theme-color" content="#87CEFA">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <style>
    @keyframes quizBGAnimation {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    @keyframes blink {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }
    @keyframes glow-green {
      0% { box-shadow: 0 0 5px rgba(0, 255, 0, 0.7); }
      50% { box-shadow: 0 0 20px rgba(0, 255, 0, 0.9); }
      100% { box-shadow: 0 0 5px rgba(0, 255, 0, 0.7); }
    }
    @keyframes glow {
      0% { box-shadow: 0 0 5px rgba(255, 0, 0, 0.7); }
      50% { box-shadow: 0 0 20px rgba(255, 0, 0, 0.7); }
      100% { box-shadow: 0 0 5px rgba(255, 0, 0, 0.7); }
    }
    /* Style général pour occuper toute la hauteur */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #2C2C2C, #555555, #888888, #BBBBBB);
      background-size: 400% 400%;
      animation: quizBGAnimation 10s ease infinite;
    }
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    /* Pour simuler un écran de téléphone (fixe à 360px de large) */
    .container {
      background: #fff;
      border: 3px solid black;
      padding: 0;
      width: 360px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      text-align: center;
      margin-bottom: 20px;
      overflow: hidden;
    }
    /* Page d'accueil */
    #home {
      position: relative;
      margin-top: 20px;
      background: linear-gradient(135deg, #2C2C2C, #555555, #888888, #BBBBBB);
      background-size: cover;
      height: 550px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 350px;
      flex-shrink: 0;
    }
    #start-btn {
      border: 2px solid white;
      border-radius: 10px;
      width: 120px;
      height: auto;
      padding: 5px 10px;
      background-color: #1a1d21;
      cursor: pointer;
      animation: glow 1.5s infinite ease-in-out;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
    }
    #start-btn:active {
      transform: scale(0.95);
      animation: glow-green 1.5s infinite ease-in-out, blink 0.3s infinite ease-in-out;
    }
    /* Zone du quiz */
    #quiz-container {
      background: linear-gradient(135deg, #2C2C2C, #555555, #888888, #BBBBBB);
      background-size: 300% 300%;
      border: solid white;
      border-radius: 10px;
      display: none;
      animation: quizBGAnimation 10s ease infinite;
    }
    .question-counter {
      font-weight: bold;
      margin-bottom: 5px;
      font-family: Arial, sans-serif;
      color: white;
      margin-top: 10px;
    }
    .question-text {
      width: 95%;
      margin: 0 auto;
      font-family: "Arial Black", Arial, sans-serif;
      font-weight: bold;
      font-size: 22px;
      margin-bottom: 15px;
      color: white;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      line-height: 1.5;
    }
    .options {
      font-family: Arial, sans-serif;
      font-weight: normal;
      font-size: 18px;
      color: white;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      text-align: left;
      margin-bottom: 20px;
      margin-left: 20px;
    }
    .option {
      margin-bottom: 20px;
    }
    .option input[type="checkbox"] {
      display: none;
      width: 40px;
      height: 40px;
      margin-right: 8px;
      vertical-align: middle;
      cursor: pointer;
    }
    .option label {
      position: relative;
      padding-left: 55px;
      cursor: pointer;
      display: inline-block;
      vertical-align: middle;
      font-size: 18px;
      line-height: 1.3;
      min-height: 40px;
    }
    .option label:before {
      content: "";
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 50px;
      height: 40px;
      background: url('https://i.imgur.com/tbgGwwi.png') no-repeat center center;
      background-size: cover;
    }
    .option input[type="checkbox"]:checked + label:before {
      background: url('https://i.imgur.com/8bK2QHk.png') no-repeat center center;
      background-size: cover;
    }
    #validate-btn {
      position: relative;
      margin: 20px auto;
      width: 120px;
      padding: 0px 10px;
      font-size: 22px;
      font-weight: bold;
      font-family: "Arial Black", Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      background-color: #1a1d21;
      border: 3px solid red;
      border-radius: 10px;
      color: white;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      margin-bottom: 0px;
      margin-top: 0px;
    }
    #validate-btn:active {
      transform: scale(0.95);
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
    }
    /* Zone de résultat */
    #result {
      margin-top: 20px;
    }
    .result-image {
      display: block;
      margin: 0 auto 20px auto;
      max-width: 150px;
    }
    .result-text {
      margin-top: 10px;
      font-size: 18px;
      font-weight: bold;
    }
    .correct-answer-text {
      color: green;
      margin-top: 8px;
    }
    .incorrect-answer-text {
      color: green;
      font-size: 20px;
      font-weight: bold;
      font-family: "Arial Black", Arial, sans-serif;
      text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff;
      margin-bottom: 10px;
      margin-top: 5px;
    }
    /* Page de résultats finale */
    #result-page {
      position: relative;
      background: linear-gradient(135deg, #A2D9FF, #74B9FF, #4A90E2, #2C3E50);
      background-size: 300% 300%;
      animation: quizBGAnimation 10s ease infinite;
      display: none;
    }
    #result-page h2 {
      margin-bottom: 20px;
    }
    #restart-btn {
      position: relative;
      margin: 20px auto;
      padding: 15px 25px;
      font-size: 22px;
      font-weight: bold;
      font-family: "Arial Black", Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      background-color: #1E90FF;
      border: 3px solid #00FFFF;
      border-radius: 10px;
      color: white;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      user-select: none;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }
    #restart-btn:active {
      transform: scale(0.95);
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
    }
    @keyframes floatImage {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    .title-image {
      margin-bottom: 10px;
      animation: floatImage 3s ease-in-out infinite;
    }
    .clouding {
      position: absolute;
      margin-bottom: 350px;
      z-index: 0;
      width: 500px;
    }
    .decoring {
      position: absolute;
      margin-top: 20px;
    }
    .pikachu {
      width: 263px;
      position: absolute;
      margin-top: -30px;
      z-index: 0;
    }
    .welcome {
      margin-top: -390px;
      z-index: 1;
    }
    .grassy {
      position: absolute;
      margin-bottom: -180px;
      z-index: 3;
    }
    .startu {
      position: absolute;
      margin-top: 425px;
      border-radius: 10px;
    }
    .mute-btn {
      position: absolute;
      margin-top: 240px;
      width: 30px;
      cursor: pointer;
      margin-right: 150px;
    }
    .hidden {
      display: none !important;
    }
    img {
      user-select: none;
      -webkit-user-drag: none;
    }
    @keyframes popAnimation {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    .result-image.correct {
      animation: popAnimation 0.5s ease-out;
      margin-bottom: 26px;
      position: relative;
      z-index: 10;
      will-change: transform;
    }
    .correct-images-wrapper, .incorrect-images-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .side-image {
      position: absolute;
      z-index: 1;
      will-change: transform;
    }
    .side-image.left {
      margin-right: -30px;
      margin-bottom: 25px;
    }
    .side-image.right {
      margin-left: -30px;
      margin-bottom: 25px;
    }
    .result-image.incorrect {
      animation: shake 0.5s ease-in-out;
      margin-bottom: 26px;
      margin-top: 1px;
    }
    @keyframes shake {
      0% { transform: translate(0, 0); }
      10% { transform: translate(-10px, 0); }
      20% { transform: translate(10px, 0); }
      30% { transform: translate(-10px, 0); }
      40% { transform: translate(10px, 0); }
      50% { transform: translate(-10px, 0); }
      60% { transform: translate(10px, 0); }
      70% { transform: translate(-10px, 0); }
      80% { transform: translate(10px, 0); }
      90% { transform: translate(-10px, 0); }
      100% { transform: translate(0, 0); }
    }
    .incorrect-answer-header {
      margin-top: -25px;
      font-weight: bold;
      font-size: 18px;
      font-family: "Arial Black", Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      color: white;
    }
    #final-score {
      margin-top: 5px;
      margin-bottom: 5px;
      font-weight: bold;
      font-size: 25px;
      font-family: "Arial Black", Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      color: #00ff1a;
    }
    #final-score2 {
      margin-top: 5px;
      margin-bottom: 5px;
      font-weight: bold;
      font-size: 25px;
      font-family: "Arial Black", Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      color: #e53517;
    }
    @keyframes shakeVertical {
      0% { transform: translateY(0); }
      10% { transform: translateY(-5px); }
      20% { transform: translateY(5px); }
      30% { transform: translateY(-5px); }
      40% { transform: translateY(5px); }
      50% { transform: translateY(0); }
      100% { transform: translateY(0); }
    }
    .shake-vertical {
      animation: shakeVertical 4s ease-in-out infinite;
    }
    .gif-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
    }
    .gif-overlay img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    @keyframes shakeWindmillPause {
      0%   { transform: rotate(0deg); }
      5%   { transform: rotate(-8deg); }
      10%  { transform: rotate(8deg); }
      15%  { transform: rotate(-8deg); }
      20%  { transform: rotate(8deg); }
      25%  { transform: rotate(-8deg); }
      30%  { transform: rotate(0deg); }
      100% { transform: rotate(0deg); }
    }
    .shake-windmill {
      animation: shakeWindmillPause 3.5s ease-in-out infinite;
      transform-origin: center;
    }
    /* Media query pour mobile : désactive certaines animations lourdes */
    @media (max-width: 480px) {
      .title-image,
      .result-image.correct,
      .result-image.incorrect,
      .side-image,
      .shake-vertical,
      .shake-windmill {
        animation: none !important;
      }
    }
  </style>
</head>
<body>
  <audio id="start-sound" src="audio/start.mp3" preload="auto"></audio>
  <audio id="checkbox-sound" src="audio/select.mp3" preload="auto"></audio>
  <audio id="correct-sound" src="audio/correct.mp3" preload="auto"></audio>
  <audio id="incorrect-sound" src="audio/incorrect.mp3" preload="auto"></audio>
  <audio id="perfect-sound" src="audio/perfect.mp3" preload="auto"></audio>
  <audio id="imperfect-sound" src="audio/imperfect.mp3" preload="auto"></audio>
  <!-- Page d'accueil -->
  <div class="container" id="home">
    <img src="https://i.imgur.com/WoDyxTe.png" alt="Welcome" width="80%" class="title-image welcome">
    <img src="https://i.imgur.com/9KYnYVl.gif" alt="pik" class="pikachu">
    <img src="https://i.imgur.com/x1sDt8Y.png" alt="tv" class="decoring" width="95%">
    <img src="https://i.imgur.com/76PVpq3.png" alt="Start" class="startu" id="start-btn">
    <img src="https://i.imgur.com/BXlVlJl.png" alt="Mute" class="mute-btn" id="mute-btn">
  </div>
  <!-- Zone du quiz -->
  <div class="container" id="quiz-container">
    <div class="question-counter" id="question-counter">Question 1 sur 3</div>
    <div class="question-text" id="question-text">[Texte de la question]</div>
    <div class="options" id="options">
      <!-- Les options seront générées ici -->
    </div>
    <button id="validate-btn"><img src="https://i.imgur.com/h1DuiuS.png" alt="Valider" style="width: 100%; height: auto; margin-top: 10px;"></button>
    <div id="result"></div>
  </div>
  <!-- Page de résultats finale -->
  <div class="container" id="result-page">
    <h2>Résultat du Quiz</h2>
    <p id="final-score">Score : 0 sur 3</p>
    <button id="restart-btn">RECOMMENCER</button>
  </div>
  <script>
    // Nouvelle fonction resetGifs() utilisant le toggle display pour réinitialiser les GIF
    function resetGifs() {
      const gifElements = document.querySelectorAll('#quiz-container img[src*=".gif"], #result-page img[src*=".gif"]');
      gifElements.forEach(gif => {
        gif.style.display = 'none';
        setTimeout(() => {
          gif.style.display = 'block';
        }, 20);
      });
    }
    // Données du quiz
    const quizData = [
      {
        question: "Sur quel feu peut-on utiliser un extincteur à eau pulvérisée avec additif (A.F.F.F):",
        options: ["Classe A", "Classe B", "Classe C", "Classe D", "Classe F", "Aucune des réponses"],
        correctAnswers: ["Classe A", "Classe B"]
      },
      {
        question: "Qu'est-ce qu'une main courante:",
        options: ["le cahier de consignes du service sécurité", "un document où l'on enregistre tous les événement de chaque journée", "un document où l'on archive les rapports des bureaux de contrôles", "Aucune des réponses"],
        correctAnswers: ["un document où l'on enregistre tous les événement de chaque journée"]
      },
      {
        question: "Qu'est-ce que l'alerte:",
        options: ["Demander l'intervention des Équipiers de Première Intervention", "Prevenir le directeur", "Prevenir le poste de sécurité", "Demander l'intervention des secours (sapeurs-pompiers/EDF/Police...)", "Aucune des réponses"],
        correctAnswers: ["Prevenir le poste de sécurité"]
      }
    ];
    let currentQuestion = 0; // Index de la question en cours
    let score = 0; // Nombre de réponses correctes
    // Références aux éléments HTML
    const homeDiv = document.getElementById("home");
    const quizContainer = document.getElementById("quiz-container");
    const startBtn = document.getElementById("start-btn");
    const questionCounter = document.getElementById("question-counter");
    const questionText = document.getElementById("question-text");
    const optionsDiv = document.getElementById("options");
    const validateBtn = document.getElementById("validate-btn");
    const resultDiv = document.getElementById("result");
    const resultPage = document.getElementById("result-page");
    const finalScoreText = document.getElementById("final-score");
    const restartBtn = document.getElementById("restart-btn");
    // Événements
    startBtn.addEventListener("click", startQuiz);
    validateBtn.addEventListener("click", validateAnswer);
    restartBtn.addEventListener("click", restartQuiz);
    // Démarrage du quiz
    function startQuiz() {
      const startSound = document.getElementById("start-sound");
      startSound.play();
      startBtn.style.boxShadow = "0 0 20px rgba(0, 255, 0, 1)";
      startBtn.style.animation = "blink 0.3s infinite ease-in-out";
      setTimeout(() => {
        startBtn.style.animation = "glow-green 1.5s infinite ease-in-out";
        homeDiv.style.display = "none";
        resultPage.style.display = "none";
        quizContainer.style.display = "block";
        currentQuestion = 0;
        score = 0;
        showQuestion();
      }, 1500);
    }
    // Ajustement des labels
    function adjustSingleLineLabels() {
      const labels = optionsDiv.querySelectorAll("label");
      labels.forEach(label => {
        if (label.offsetHeight <= 40) {
          label.style.display = "flex";
          label.style.alignItems = "center";
          label.style.height = "40px";
        } else {
          label.style.display = "inline-block";
          label.style.height = "auto";
        }
      });
    }
    // Affiche la question en cours et ses options
    function showQuestion() {
      resultDiv.innerHTML = "";
      validateBtn.style.display = "inline-block";
      validateBtn.disabled = false;
      const data = quizData[currentQuestion];
      questionCounter.textContent = (currentQuestion + 1) + "/" + quizData.length;
      questionText.textContent = data.question;
      optionsDiv.innerHTML = "";
      data.options.forEach((option, index) => {
        const div = document.createElement("div");
        div.className = "option";
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.value = option;
        checkbox.name = "option";
        checkbox.id = "option_" + index;
        checkbox.addEventListener("click", () => {
          const checkboxSound = document.getElementById("checkbox-sound");
          checkboxSound.currentTime = 0;
          checkboxSound.play();
        });
        const label = document.createElement("label");
        label.textContent = option;
        label.htmlFor = checkbox.id;
        div.appendChild(checkbox);
        div.appendChild(label);
        optionsDiv.appendChild(div);
      });
      setTimeout(adjustSingleLineLabels, 0);
    }
    // Vérifie la réponse de l'utilisateur
    function validateAnswer() {
      const data = quizData[currentQuestion];
      const selectedOptions = Array.from(document.querySelectorAll('input[name="option"]:checked'))
                                   .map(el => el.value);
      if (selectedOptions.length === 0) {
        alert("Veuillez sélectionner au moins une réponse");
        return;
      }
      const sortedSelectedOptions = selectedOptions.slice().sort();
      const sortedCorrectAnswers = data.correctAnswers.slice().sort();
      const isCorrect = arraysEqual(sortedSelectedOptions, sortedCorrectAnswers);
      validateBtn.style.display = "none";
      if (isCorrect) {
        score++;
        const correctSound = document.getElementById("correct-sound");
        correctSound.currentTime = 0;
        correctSound.play();
        resultDiv.innerHTML = `
          <div class="correct-images-wrapper">
            <img src="https://i.imgur.com/zri8rll.gif" alt="Left decoration" class="side-image left">
            <img src="https://i.imgur.com/2y2kmUp.png" alt="Correct" class="result-image correct" style="width: 60px;">
            <img src="https://i.imgur.com/VwNEffr.gif" alt="Right decoration" class="side-image right">
          </div>
        `;
        resetGifs();
      } else {
        const incorrectSound = document.getElementById("incorrect-sound");
        incorrectSound.currentTime = 0;
        incorrectSound.play();
        const correctAnswersInOrder = data.options.filter(option => data.correctAnswers.includes(option));
        resultDiv.innerHTML = `
          <div class="incorrect-images-wrapper">
            <img src="https://i.imgur.com/AhLyHkm.png" alt="Left decoration" class="side-image left">
            <img src="https://i.imgur.com/wGqNOcs.png" alt="Incorrect" class="result-image incorrect" style="width:60px;">
            <img src="https://i.imgur.com/5twMjUW.png" alt="Right decoration" class="side-image right">
          </div>
          <div class="incorrect-answer-header">Réponse :</div>
          <div class="incorrect-answer-text">${correctAnswersInOrder.join(", ")}</div>
        `;
        resetGifs();
      }
      const delay = isCorrect ? 2000 : 4000;
      setTimeout(() => {
        currentQuestion++;
        if (currentQuestion < quizData.length) {
          showQuestion();
        } else {
          showResultPage();
        }
      }, delay);
    }
    function showResultPage() {
      quizContainer.style.display = "none";
      const scoreText = "Score : " + score + " sur " + quizData.length;
      if (score === quizData.length) {
        resultPage.innerHTML = `
          <div class="gif-overlay">
            <img src="https://i.imgur.com/66ppZv0.gif" alt="Perfect GIF">
          </div>
          <img src="https://i.imgur.com/IGPRzpC.png" alt="res quiz" class="shake-vertical" style="margin-top: 10px">
          <img src="https://i.imgur.com/AM2FkWm.gif" alt="Perfect" style="width:120px; margin-bottom: -20px; margin-left: -22px; position: relative; z-index: 2;">
          <p id="final-score" style="font-weight:bold; color:#00ff1a;">${scoreText}</p>
          <button id="restart-btn" style="position: relative; z-index: 2;">RECOMMENCER</button>
        `;
        const perfectSound = document.getElementById("perfect-sound");
        perfectSound.currentTime = 0;
        perfectSound.play();
      } else {
        resultPage.innerHTML = `
          <img src="https://i.imgur.com/H16Il0Z.png" alt="res quiz2" style="margin-top: 10px" class="shake-windmill">
          <img src="https://i.imgur.com/mpMMoec.gif" alt="Imperfect" style="width:200px; margin-bottom: -10px; margin-top: -10px;">
          <p id="final-score2" style="font-weight:bold; color:#FF0000;">${scoreText}</p>
          <button id="restart-btn">RECOMMENCER</button>
        `;
        const imperfectSound = document.getElementById("imperfect-sound");
        imperfectSound.currentTime = 0;
        imperfectSound.play();
      }
      resultPage.style.display = "block";
      document.getElementById("restart-btn").addEventListener("click", restartQuiz);
    }
    function restartQuiz() {
      document.querySelectorAll('audio').forEach(audio => {
        audio.pause();
        audio.currentTime = 0;
      });
      document.body.classList.add('hidden');
      setTimeout(() => {
        window.location.reload();
      }, 100);
    }
    function arraysEqual(arr1, arr2) {
      if (arr1.length !== arr2.length) return false;
      for (let i = 0; i < arr1.length; i++) {
        if (arr1[i] !== arr2[i]) return false;
      }
      return true;
    }
    const muteBtn = document.getElementById("mute-btn");
    let isMuted = false;
    muteBtn.addEventListener("click", () => {
      isMuted = !isMuted;
      if (isMuted) {
        document.querySelectorAll('audio, video').forEach(media => media.muted = true);
        muteBtn.src = "https://i.imgur.com/pXbvxY4.png";
      } else {
        document.querySelectorAll('audio, video').forEach(media => media.muted = false);
        muteBtn.src = "https://i.imgur.com/3WSvsVf.png";
      }
    });
  </script>
</body>
</html>
