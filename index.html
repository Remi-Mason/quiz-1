<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Quiz Sécurité Incendie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Préchargement de quelques images critiques -->
  <link rel="preload" as="image" href="images/correct.png">
  <link rel="preload" as="image" href="images/incorrect.png">
  <style>
    /* animations */
	@keyframes borderGlow {
  0%, 100% {
    box-shadow: 0 0 5px 2px #00e5ff;  /* Glow léger autour de la bordure */
  }
  50% {
    box-shadow: 0 0 20px 2px #00e5ff; /* Intensification du glow */
  }
}
    /* Styles généraux et mobile-friendly */
    html, body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
    }
   .container {
      width: 360px;
      max-width: 90%;
      background: linear-gradient(135deg, #1a1a1a, #333333);
      border: 3px solid white; /* Bordure rouge vif */
      border-radius: 15px;
      text-align: center;
      padding: 30px;
      margin: 20px auto;
      transition: transform 0.3s ease;
    }
    /* Page d'accueil */
    #home {
      display: block;
	  background: url('images/wall.png') no-repeat center center;
	    background-size: cover;
    }
    #home h1 {
      font-size: 24px;
      margin-bottom: 20px;
    }
    #start-btn, #mute-btn {
      padding: 10px 20px;
      font-size: 18px;
      border: none;
      border-radius: 5px;
      margin: 5px;
      cursor: pointer;
    }
    #start-btn {
      background-color: #1a1d21;
      color: #fff;
    }
    #mute-btn {
      background-color: #555;
      color: #fff;
    }
    /* Zone du quiz */
    #quiz-container {
	  background: linear-gradient(135deg, #2c2c2c, #808080);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      text-align: center;
      display: none;
    }
    #question-counter {
      font-weight: bold;
      margin-bottom: 5px;
      font-family: 'Arial', Arial, sans-serif;
      color: white;
      margin-top: -10px;
	  margin-bottom: 10px;
    }
    #question-text {
	width: 95%;
      margin: 0 auto;
      font-family: 'Arial Black', Arial, sans-serif;
      font-weight: bold;
      font-size: 22px;
      margin-bottom: 15px;
       color: white;
    text-shadow:
    -1px -1px 0 #000,
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000,
    3px 3px 5px black;
	  line-height: 1.5;
    }
    .options {
       font-family: Arial, sans-serif;  /* Utilise Arial sans graisse */
     font-weight: normal;  
     font-size: 18px;
     color: white;
     text-shadow:
    -1px -1px 0 #000,
    1px -1px 0 #000,
    -1px 1px 0 #000,
    1px 1px 0 #000,
    3px 3px 5px black;
      text-align: left;
      margin-bottom: 30px;
      margin-left: 20px;
	  padding-left: 20px;
	  margin: 0;
    }
    .option {
  display: flex;
  align-items: center;
  justify-content: flex-start; /* Aligne le contenu à gauche */
  margin-bottom: 10px;
    }
    /* Masquer le checkbox natif */
    .option input[type="checkbox"] {
      display: none;
    }
.option label {
  display: inline-flex;
  align-items: center;
}
.option label:before {
  content: "";
  display: inline-block;
  width: 60px;      /* Augmenté de 40px à 60px */
  height: 60px;     /* Augmenté de 40px à 60px */
  margin-right: 8px;
  margin-left: -45px;
  background: url('images/fire empty.png') no-repeat center;
  background-size: contain;
  flex-shrink: 0;   /* Empêche l'image de rétrécir */
}
 .option input[type="checkbox"]:checked + label:before {
  background: url('images/fire full.png') no-repeat center;
  background-size: contain;
  width: 60px;      /* Même dimension pour conserver l'homogénéité */
  height: 60px;
}
  #validate-btn {
  padding: 10px 20px;
  font-size: 18px;
  border: 3px solid white;
  border-radius: 10px;
  background-color: #1a1d21;
  color: white;
  cursor: pointer;
  transition: transform 0.1s ease, box-shadow 0.1s ease;
  animation: borderGlow 2s ease-in-out infinite;
}

#validate-btn:active {
  transform: translateY(2px) scale(0.98); /* Légère translation et réduction pour simuler un appui */
  box-shadow: 0 0 5px 5px rgba(255, 255, 255, 0.8);
}
    #result {
      margin-top: 20px;
    }
    .result-image {
      width: 60px;
      display: block;
      margin: 10px auto;
    }
    .correction-text {
      font-size: 18px;
      color: green;
      margin-top: 10px;
    }
    /* Page finale */
    #result-page {
      display: none;
    }
    #result-page h2 {
      font-size: 24px;
      margin-bottom: 20px;
    }
    #final-score {
      font-size: 22px;
      margin-bottom: 20px;
    }
    #restart-btn {
      padding: 10px 20px;
      font-size: 18px;
      border: none;
      border-radius: 5px;
      background-color: #1E90FF;
      color: #fff;
      cursor: pointer;
    }
    /* Media Query pour mobile */
    @media (max-width: 480px) {
      .container {
        width: 90%;
        padding: 15px;
      }
      #question-text {
        font-size: 18px;
      }
      #final-score {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <!-- Éléments audio -->
  <audio id="checkbox-sound" src="audio/select.mp3" preload="auto"></audio>
  <audio id="start-sound" src="audio/start.mp3" preload="auto"></audio>
  <audio id="correct-sound" src="audio/correct.mp3" preload="auto"></audio>
  <audio id="incorrect-sound" src="audio/incorrect.mp3" preload="auto"></audio>
  
  <!-- Page d'accueil -->
  <div class="container" id="home">
    <h1>Quiz Sécurité Incendie</h1>
    <button id="mute-btn">Mute</button>
    <button id="start-btn">Commencer</button>
  </div>
  
  <!-- Zone du quiz -->
  <div class="container" id="quiz-container">
    <div id="question-counter">Question 1 / 3</div>
    <div id="question-text">[Texte de la question]</div>
    <div class="options" id="options">
      <!-- Les options seront générées dynamiquement -->
    </div>
    <button id="validate-btn">Valider</button>
    <div id="result"></div>
  </div>
  
  <!-- Page de résultats finale -->
  <div class="container" id="result-page">
    <h2>Résultat du Quiz</h2>
    <p id="final-score">Score : 0 sur 3</p>
    <img id="final-image" src="" alt="Résultat" style="width:120px; display:block; margin: 0 auto 20px;">
    <button id="restart-btn">Recommencer</button>
  </div>
  
  <script>
    // Données du quiz (exemple)
    const quizData = [
      {
        question: "Sur quel feu peut-on utiliser un extincteur à eau pulvérisée avec additif ?",
        options: ["Feu de classe A avec option tu vas aller a la ligne stp", "Feu de classe B", "Feu de classe C", "Feu de classe D"],
        correctAnswers: ["Feu de classe A", "Feu de classe B"]
      },
      {
        question: "Que signifie le signal d'alarme incendie ?",
        options: ["Évacuation immédiate", "Appeler le service incendie", "Rester à votre poste", "Ignorer le signal"],
        correctAnswers: ["Évacuation immédiate"]
      },
      {
        question: "Quel équipement de sécurité incendie est obligatoire dans un établissement ?",
        options: ["Extincteur", "Détecteur de fumée", "Réseau d'alarme", "Toutes les réponses"],
        correctAnswers: ["Toutes les réponses"]
      }
    ];
    
    let currentQuestion = 0;
    let score = 0;
    let isMuted = false;
    
    // Références aux éléments
    const homeDiv = document.getElementById("home");
    const quizContainer = document.getElementById("quiz-container");
    const resultPage = document.getElementById("result-page");
    const questionCounterEl = document.getElementById("question-counter");
    const questionTextEl = document.getElementById("question-text");
    const optionsDiv = document.getElementById("options");
    const resultDiv = document.getElementById("result");
    const finalScoreEl = document.getElementById("final-score");
    const finalImage = document.getElementById("final-image");
    
    const startBtn = document.getElementById("start-btn");
    const validateBtn = document.getElementById("validate-btn");
    const restartBtn = document.getElementById("restart-btn");
    const muteBtn = document.getElementById("mute-btn");
    
    const checkboxSound = document.getElementById("checkbox-sound");
    const startSound = document.getElementById("start-sound");
    const correctSound = document.getElementById("correct-sound");
    const incorrectSound = document.getElementById("incorrect-sound");
    
    // Démarrer le quiz (inclut le verrouillage de l'orientation)
    startBtn.addEventListener("click", () => {
      // Verrouillage de l'orientation en portrait (nécessite HTTPS et interaction utilisateur)
      if (screen.orientation && screen.orientation.lock) {
        screen.orientation.lock("portrait").catch(error => {
          console.log("Le verrouillage de l'orientation a échoué :", error);
        });
      }
      
      startSound.play();
      homeDiv.style.display = "none";
      quizContainer.style.display = "block";
      currentQuestion = 0;
      score = 0;
      showQuestion();
    });
    
    // Activer/désactiver le son
    muteBtn.addEventListener("click", () => {
      isMuted = !isMuted;
      [startSound, correctSound, incorrectSound, checkboxSound].forEach(audio => {
        audio.muted = isMuted;
      });
      muteBtn.textContent = isMuted ? "Unmute" : "Mute";
    });
    
    // Affiche la question et les options
    function showQuestion() {
      resultDiv.innerHTML = "";
      const data = quizData[currentQuestion];
      questionCounterEl.textContent = `${currentQuestion + 1} / ${quizData.length}`;
      questionTextEl.textContent = data.question;
      optionsDiv.innerHTML = "";
      data.options.forEach((option, index) => {
        const div = document.createElement("div");
        div.className = "option";
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.value = option;
        checkbox.name = "option";
        checkbox.id = `option_${index}`;
        // Ajout du son lors du clic sur la checkbox
        checkbox.addEventListener("click", () => {
          checkboxSound.currentTime = 0;
          checkboxSound.play();
        });
        const label = document.createElement("label");
        label.htmlFor = `option_${index}`;
        label.textContent = option;
        div.appendChild(checkbox);
        div.appendChild(label);
        optionsDiv.appendChild(div);
      });
    }
    
    // Fonction utilitaire pour comparer deux tableaux (ordre non important)
    function arraysEqual(a, b) {
      if (a.length !== b.length) return false;
      const sortedA = a.slice().sort();
      const sortedB = b.slice().sort();
      return sortedA.every((val, index) => val === sortedB[index]);
    }
    
    // Validation de la réponse
    validateBtn.addEventListener("click", () => {
      const data = quizData[currentQuestion];
      const selected = Array.from(document.querySelectorAll('input[name="option"]:checked')).map(el => el.value);
      if (selected.length === 0) {
        alert("Veuillez sélectionner au moins une réponse");
        return;
      }
      const isCorrect = arraysEqual(selected, data.correctAnswers);
      validateBtn.style.display = "none";
      if (isCorrect) {
        score++;
        correctSound.currentTime = 0;
        correctSound.play();
        // Afficher l'image centrale de bonne réponse
        resultDiv.innerHTML = `<img src="images/correct.png" alt="Bonne réponse" class="result-image correct">`;
      } else {
        incorrectSound.currentTime = 0;
        incorrectSound.play();
        // Afficher l'image centrale de mauvaise réponse et le texte de correction
        resultDiv.innerHTML = `
          <img src="images/incorrect.png" alt="Mauvaise réponse" class="result-image incorrect">
          <div class="correction-text">Bonne réponse : ${data.correctAnswers.join(", ")}</div>
        `;
      }
      setTimeout(() => {
        currentQuestion++;
        if (currentQuestion < quizData.length) {
          showQuestion();
          validateBtn.style.display = "block";
        } else {
          showResultPage();
        }
      }, 2000);
    });
    
    // Affichage de la page finale
    function showResultPage() {
      quizContainer.style.display = "none";
      resultPage.style.display = "block";
      finalScoreEl.textContent = `Score : ${score} sur ${quizData.length}`;
      // Choisir l'image finale selon le score
      finalImage.src = (score === quizData.length) ? "images/perfect.png" : "images/imperfect.png";
    }
    
    // Bouton de redémarrage
    restartBtn.addEventListener("click", () => {
      window.location.reload();
    });
  </script>
</body>
</html>
