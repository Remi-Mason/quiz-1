<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Quiz Sécurité Incendie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Couleur pour Android (Chrome) -->
  <meta name="theme-color" content="#A9A9A9">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Préchargement de quelques images critiques -->
  <link rel="preload" as="image" href="images/wall.png">
  <link rel="preload" as="image" href="images/wall2.png">
  <link rel="preload" as="image" href="images/correct.png">
  <link rel="preload" as="image" href="images/incorrect.png">
  <link rel="preload" as="image" href="images/decor1.gif">
  <link rel="preload" as="image" href="images/decor2.gif">
  <link rel="preload" as="image" href="images/fire empty.png">
  <link rel="preload" as="image" href="images/fire full.png">
  <link rel="preload" as="image" href="images/ryu.gif">
  <link rel="preload" as="image" href="images/ken.gif">
  <link rel="preload" as="image" href="images/ryu2.gif">
  <link rel="preload" as="image" href="images/ken2.gif">
  <link rel="preload" as="image" href="images/mute-off.gif">
  <link rel="preload" as="image" href="images/mute-on.gif">
  <link rel="preload" as="image" href="images/perfect.gif">
  <link rel="preload" as="image" href="images/tryagain.png">
  <link rel="preload" as="image" href="images/youwin.png">
  <link rel="preload" as="image" href="images/lose1.gif">
  <link rel="preload" as="image" href="images/lose2.gif">
  
  <style>
    /* Animations et styles identiques à votre version initiale */
    @keyframes shake {
      0% { transform: translate(0, 0); }
      10% { transform: translate(-10px, -10px); }
      20% { transform: translate(10px, 10px); }
      30% { transform: translate(-10px, 10px); }
      40% { transform: translate(10px, -10px); }
      50% { transform: translate(-10px, -10px); }
      60% { transform: translate(10px, 10px); }
      70% { transform: translate(-10px, 10px); }
      80% { transform: translate(10px, -10px); }
      90% { transform: translate(-10px, -10px); }
      100% { transform: translate(0, 0); }
    }
    @keyframes popAnimation {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    @keyframes blink {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }
    @keyframes glow-green {
      0% { box-shadow: 0 0 5px rgba(0,255,0,0.7); }
      50% { box-shadow: 0 0 20px rgba(0,255,0,0.9); }
      100% { box-shadow: 0 0 5px rgba(0,255,0,0.7); }
    }
    @keyframes borderGlow {
      0%, 100% { box-shadow: 0 0 5px 2px #00e5ff; }
      50% { box-shadow: 0 0 20px 2px #00e5ff; }
    }
    @keyframes borderGlow2 {
      0%, 100% { box-shadow: 0 0 5px 2px rgba(255,0,0,0.7); }
      50% { box-shadow: 0 0 20px 2px rgba(255,0,0,0.7); }
    }
    @keyframes borderGlowGreen {
      0%, 100% { box-shadow: 0 0 5px 2px rgba(0,255,0,0.7); }
      50% { box-shadow: 0 0 20px 2px rgba(0,255,0,0.7); }
    }
    @keyframes floatAnimation {
      0%   { transform: translateY(0); }
      25%  { transform: translateY(-3px); }
      50%  { transform: translateY(0); }
      75%  { transform: translateY(5px); }
      100% { transform: translateY(0); }
    }
    .floating-title {
      animation: floatAnimation 8s ease-in-out infinite;
      display: block;
      margin: 0 auto 20px;
      max-width: 90%;
    }
    .pikachu {
      border: 3px solid white;
      display: block;
      margin: 0 auto;
      max-width: 100%;
      margin-bottom: 20px;
    }
    #result-header {
      display: block;
      margin: 0 auto 20px;
      margin-left: 20px;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #2C2C2C, #555555, #888888, #BBBBBB);
      background-size: 100% 100%;
    }
    body {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      width: 360px;
      max-width: 90%;
      background: url('images/wall.png') no-repeat center center;
      background-size: cover;
      border: 3px solid white;
      border-radius: 15px;
      text-align: center;
      padding: 30px;
      margin: 20px auto;
      transition: transform 0.3s ease;
    }
    #home { width: 360px; }
    #start-btn {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 140px;
      height: 80px;
      margin: 20px auto;
      padding: 5px 10px;
      font-size: 18px;
      cursor: pointer;
      background: linear-gradient(to top, black, gray);
      color: white;
      font-weight: bold;
      border: 2px solid white;
      border-radius: 10px;
      text-shadow: 1px 1px 2px black;
      transition: transform 0.1s ease-in-out;
      animation: borderGlow 2s ease-in-out infinite;
      position: relative;
      overflow: visible;
    }
    #start-btn:active {
      transform: scale(0.95);
      animation: glow-green 1.5s infinite ease-in-out, blink 0.3s infinite ease-in-out;
    }
    #start-btn img {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 140px;
      height: auto;
      pointer-events: none;
    }
    #quiz-container {
      background: linear-gradient(135deg, #2c2c2c, #808080);
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      text-align: center;
      display: none;
    }
    #question-counter {
      font-weight: bold;
      font-family: Arial, sans-serif;
      color: white;
      margin-top: -20px;
      margin-bottom: 0px;
    }
    #question-text {
      width: 95%;
      margin: 0 auto;
      font-family: 'Arial Black', Arial, sans-serif;
      font-weight: bold;
      font-size: 22px;
      margin-bottom: 10px;
      color: white;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      line-height: 1.5;
    }
    .options {
      font-family: Arial, sans-serif;
      font-size: 18px;
      color: white;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      text-align: left;
      margin: 0 0 30px 20px;
      padding-left: 20px;
    }
    .option {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      margin-bottom: 10px;
    }
    .option input[type="checkbox"] { display: none; }
    .option label { display: inline-flex; align-items: center; }
    .option label:before {
      content: "";
      display: inline-block;
      width: 60px;
      height: 60px;
      margin-right: 8px;
      margin-left: -60px;
      background: url('images/fire empty.png') no-repeat center;
      background-size: contain;
      flex-shrink: 0;
    }
    .option input[type="checkbox"]:checked + label:before {
      background: url('images/fire full.png') no-repeat center;
      background-size: contain;
      width: 60px;
      height: 60px;
    }
    #validate-btn, #next-btn {
      font-weight: bold;
      margin: 0 auto;
      margin-top: 30px;
      display: block;
      padding: 15px 25px;
      font-size: 25px;
      border: 3px solid white;
      border-radius: 10px;
      background-color: #1a1d21;
      color: white;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.1s ease;
      animation: borderGlow 2s ease-in-out infinite;
    }
    #validate-btn:active, #next-btn:active { transform: translateY(2px) scale(0.98); }
    #result { margin-top: 20px; }
    .result-image {
      width: 60px;
      display: block;
      margin: 10px auto;
    }
    .incorrect-answer-text {
      color: red;
      font-size: 20px;
      font-weight: bold;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff, 3px 3px 5px black;
        margin-bottom: 10px;
  margin-top: 0px;
    }
    .incorrect-answer-header {
      margin-top: -40px;
      font-weight: bold;
      font-size: 18px;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      color: white;
    }
    /* Nouveau conteneur pour décaler le bloc réponse quand le bouton "Suivant" apparaît */
    .incorrect-answer-wrapper {
      margin-top: 20px;
    }
    .correct-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .correct-decoration { width: 60px; }
    .correct-container .result-image.correct {
      animation: popAnimation 0.5s ease-out;
      width: 80px;
      margin-top: -40px;
      z-index: 1;
    }
    .result-image.incorrect {
      width: 80px;
      margin-top: -60px;
      animation: shake 0.5s ease-in-out;
    }
    #result-page { display: none; }
    #result-page h2 { font-size: 24px; margin-bottom: 20px; }
    #final-score {
      margin-top: -10px;
      margin-bottom: 0px;
      font-weight: bold;
      font-size: 25px;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;
      color: #00ff1a;
    }
    #restart-btn {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 160px;
      height: 65px;
      margin: 20px auto;
      padding: 5px 20px;
      font-size: 18px;
      cursor: pointer;
      background: linear-gradient(to top, black, gray);
      color: white;
      font-weight: bold;
      border: 2px solid white;
      border-radius: 10px;
      text-shadow: 1px 1px 2px black;
      transition: transform 0.1s ease-in-out;
      position: relative;
      overflow: visible;
      animation: borderGlow2 2s ease-in-out infinite;
    }
    #restart-btn:active { transform: scale(0.95); }
    @media (max-width: 480px) {
      .container { width: 90%; padding: 15px; padding-top: 20px; }
      #question-text { font-size: 18px; }
      #final-score { font-size: 20px; }
      .floating-title { margin: 0 auto 10px; }
      .pikachu { margin: 0 auto; }
    }
    .startu { border-radius: 10px; }
    .decor-right {
      width: 80px;
      transform: translate(-32px, -20px);
      z-index: 0;
      padding: 12px 0px;
    }
    .decor-left {
      width: 80px;
      transform: translate(30px, -20px);
      z-index: 0;
      padding: 12px 0px;
    }
    .incorrect-container {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .decor-rightX {
      width: 80px;
      transform: translate(-40px, -40px);
      z-index: 0;
      padding: 12px 0px;
    }
    .decor-leftX {
      width: 80px;
      transform: translate(40px, -40px);
      z-index: 0;
      padding: 12px 0px;
    }
    .again {
      display: block;
      margin: 0 auto;
    }
    @keyframes windmillShake {
      0% { transform: rotate(0deg); }
      15% { transform: rotate(15deg); }
      30% { transform: rotate(-15deg); }
      45% { transform: rotate(10deg); }
      60% { transform: rotate(-10deg); }
      75% { transform: rotate(5deg); }
      90% { transform: rotate(-5deg); }
      100% { transform: rotate(0deg); }
    }
    .windmill-shake {
      animation: windmillShake 0.8s ease-in-out forwards;
      transform-origin: center;
    }
    .raised {
      transform: translateY(-20px);
      margin-bottom: -10px !important;
    }
    @keyframes victoryAnimation {
      0% { transform: scale(1) rotate(0deg); }
      20% { transform: scale(1.1) rotate(3deg); }
      40% { transform: scale(1) rotate(-3deg); }
      60% { transform: scale(1.1) rotate(3deg); }
      80% { transform: scale(1) rotate(-3deg); }
      90% { transform: scale(1) rotate(0deg); }
      100% { transform: scale(1) rotate(0deg); }
    }
    .victory-animation {
      animation: victoryAnimation 2s ease-in-out infinite;
      transform-origin: center;
    }
    @media (max-width: 480px) {
      .pikachu {
        width: 85%;
        margin: 0 auto;
        transform: translateX(0px);
      }
    }
    @media (max-width: 480px) {
      .again {
        width: 85%;
        margin: 0 auto;
        transform: translateX(0px);
      }
    }
    @media (max-width: 480px) {
      #result-header {
        display: block;
        margin: 0 auto 20px;
        width: 85%;
      }
    }
    @media (max-width: 480px) {
      .decor-right {
        width: 80px;
        transform: translate(-12px, -20px);
        z-index: 0;
        padding: 12px 0px;
      }
    }
    @media (max-width: 480px) {
      .decor-left {
        width: 80px;
        transform: translate(10px, -20px);
        z-index: 0;
        padding: 12px 0px;
      }
    }
    @media (max-width: 480px) {
      .decor-rightX {
        width: 80px;
        transform: translate(-10px, -40px);
        z-index: 0;
        padding: 12px 0px;
      }
    }
    @media (max-width: 480px) {
      .decor-leftX {
        width: 80px;
        transform: translate(10px, -40px);
        z-index: 0;
        padding: 12px 0px;
      }
    }
    @media (max-width: 480px) {
      #question-text { font-size: 22px; }
    }
    @media (max-width: 480px) {
      #mute-btn {
        margin-top: 30px!important;
      }
    }
    @media (max-width: 480px) {
      #final-score {
        font-size: 28px !important;
      }
    }
    /* Fin ajout règle */
    #next-btn {
      position: relative;
      top: -30px;
      color: #00e5ff;
    }
        @media (max-width: 480px) {
     .incorrect-answer-text {
      color: red;
      font-size: 20px;
      font-weight: bold;
      font-family: 'Arial Black', Arial, sans-serif;
      text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff, 3px 3px 5px black;
      margin: 5px 0 10px;
    }
    
    /* Styles pour le modal de l'index */
#index-modal {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0, 0, 0, 0.5); /* Fond noir avec 50% d'opacité */
  padding: 20px;
  border-radius: 15px;
  z-index: 1000;
  text-align: center;
  width: 300px;      /* Largeur définie pour ne pas prendre toute la largeur */
  max-width: 80%;    /* Adaptatif sur mobile */
}

/* Boutons INDEX agrandis à l'intérieur du modal */
#index-modal .index-option {
  width: 60px;                  /* Bouton plus grand */
  height: 60px;
  margin: 0 10px;
  font-size: 18px;              /* Texte agrandi */
  border: 2px solid white;
  border-radius: 50%;
  background: linear-gradient(to top, black, gray);
  color: white;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.1s ease-in-out;
}

#index-modal .index-option:active {
  transform: scale(0.95);
}

/* Optionnel : ajuster le bouton de fermeture */
#index-modal #close-index-modal {
  margin-top: 20px;
  padding: 8px 16px;
  font-size: 16px;
  border: 2px solid white;
  border-radius: 5px;
  background: linear-gradient(to top, black, gray);
  color: white;
  cursor: pointer;
  transition: transform 0.1s ease-in-out;
}
#index-btn {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 160px;               /* Taille adaptée */
  height: 65px;               /* Taille adaptée */
  margin: 20px auto;
  padding: 5px 20px;
  font-size: 18px;
  cursor: pointer;
  background: linear-gradient(to top, black, gray);
  color: white;
  font-weight: bold;
  border: 2px solid white;
  border-radius: 10px;
  text-shadow: 1px 1px 2px black;
  transition: transform 0.1s ease-in-out;
  animation: borderGlow 2s ease-in-out infinite;  /* Border glow bleu */
}

#index-btn:active {
  transform: scale(0.95);  /* Effet push-button */
}
  </style>
</head>
<body>
  <!-- Éléments audio -->
  <audio id="checkbox-sound" src="audio/select.mp3" preload="auto"></audio>
  <audio id="start-sound" src="audio/start.mp3" preload="auto"></audio>
  <audio id="correct-sound" src="audio/correct.mp3" preload="auto"></audio>
  <audio id="incorrect-sound" src="audio/incorrect.mp3" preload="auto"></audio>
  <audio id="incorrect-sound2" src="audio/incorrect2.mp3" preload="auto"></audio>
  <audio id="perfect-sound" src="audio/perfect.mp3" preload="auto"></audio>
  <audio id="imperfect-sound" src="audio/imperfect.mp3" preload="auto"></audio>
  
  <!-- Page d'accueil -->
  <div class="container" id="home">
  <img src="images/titre.png" alt="quiz ssiap1" class="floating-title">
  <img src="" alt="pik" class="pikachu" style="visibility: hidden;">
  <div class="mute-wrapper" style="position: relative; display: inline-block; text-align: center;">
    <img id="mute-btn" src="images/mute-off.gif" alt="Son activé" style="cursor: pointer; width: 30px; height: 25px; margin: 10px auto; display: block;">
    <img id="additional-image" src="images/diez.png" alt="Nouvelle image" 
         style="position: absolute; right: -120px; top: 50%; transform: translateY(-50%); cursor: pointer; width: 60px;">
  </div>
  <button id="start-btn"><img src="images/start.png" style="margin-left: 5px;"></button>
  <button id="home-index-btn" class="index-btn">INDEX</button>
</div>
  
  <!-- Zone du quiz -->
  <div class="container" id="quiz-container">
    <div id="question-counter"> 1 / <span id="total-questions"></span></div>
    <div id="question-text">[Texte de la question]</div>
    <div class="options" id="options">
      <!-- Les options seront générées dynamiquement -->
    </div>
    <button id="validate-btn">Valider</button>
    <div id="result"></div>
  </div>
  
  <!-- Page de résultats finale -->
  <div class="container" id="result-page">
    <img id="result-header" src="images/tryagain.png" alt="encore" class="again">
    <img id="final-image" src="images/lose1.gif" alt="Résultat" style="width:120px; display:block; margin: -15px auto 20px;">
    <p id="final-score">Score : 0 sur <span id="total-questions-result"></span></p>
    <button id="restart-btn" style="text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;">RECOMMENCER</button>
    <button id="index-btn" style="text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000, 3px 3px 5px black;">INDEX</button>
  </div>
  
  <!-- Container modal pour l'index -->
<div id="index-modal" style="display: none;">
  <button class="index-option" data-url="https://remi-mason.github.io/quiz-1/">1</button>
  <button class="index-option" data-url="https://remi-mason.github.io/quiz-1-2/">2</button>
  <button class="index-option" data-url="https://remi-mason.github.io/quiz-1-3/">3</button>
  <br>
  <button id="close-index-modal">Fermer</button>
</div>
  
  <script>
    // Données du quiz générées à partir du questionnaire
    const quizData = [
{
    "question": "De quoi est principalement composé l’air ?",
    "options": [
      "78 % d’azote",
      "21 % d’oxygène",
      "1 % de gaz rares et CO₂",
      "Uniquement d’oxygène",
      "Principalement de CO₂",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "78 % d’azote",
      "21 % d’oxygène",
      "1 % de gaz rares et CO₂"
    ]
  },
  {
    "question": "Quelle est la température de la flamme ?",
    "options": [
      "Entre 600°C et 1200°C",
      "Toujours < 500°C",
      "Peut dépasser 2000°C",
      "Toujours exactement 800°C",
      "Dépend uniquement du combustible",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Entre 600°C et 1200°C",
      "Peut dépasser 2000°C"
    ]
  },
  {
    "question": "Quels sont les éléments du triangle du feu ?",
    "options": [
      "Combustible",
      "Comburant (oxygène)",
      "Énergie d’activation",
      "Excès de CO₂",
      "Seulement combustible et énergie",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Combustible",
      "Comburant (oxygène)",
      "Énergie d’activation"
    ]
  },
  {
    "question": "Qu’est-ce que le point éclair ?",
    "options": [
      "Température où un combustible émet des vapeurs qui s’enflamment sans persistance des flammes",
      "Température où un combustible s’évapore totalement",
      "Température minimale d’auto-inflammation",
      "Température où un combustible s’enflamme avec persistance des flammes",
      "Température maximale de combustion",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Température où un combustible émet des vapeurs qui s’enflamment sans persistance des flammes"
    ]
  },
  {
    "question": "Qu’est-ce que le point d’inflammation ?",
    "options": [
      "Température où un combustible s’enflamme avec persistance des flammes",
      "Température de fusion d’un combustible",
      "Température où un combustible s’enflamme sans persistance des flammes",
      "Température maximale de combustion",
      "Température d’extinction d’un combustible",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Température où un combustible s’enflamme avec persistance des flammes"
    ]
  },
  {
    "question": "Qu’est-ce que le point d’auto-inflammation ?",
    "options": [
      "Température où un corps s’enflamme sans contact avec une flamme",
      "Température où un combustible s’enflamme avec persistance des flammes",
      "Toujours < 100°C",
      "Identique pour tous les combustibles",
      "Dépend uniquement de la pression",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Température où un corps s’enflamme sans contact avec une flamme"
    ]
  },
  {
    "question": "Qu’est-ce que le pouvoir calorifique ?",
    "options": [
      "Quantité de chaleur dégagée par la combustion d’1 kg ou 1 m³ de combustible",
      "Température de combustion spontanée",
      "Exprimé en kJ/kg ou kJ/m³",
      "Identique pour tous les combustibles",
      "Mesure l’oxygène consommé par la combustion",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Quantité de chaleur dégagée par la combustion d’1 kg ou 1 m³ de combustible",
      "Exprimé en kJ/kg ou kJ/m³"
    ]
  },
  {
    "question": "Qu’est-ce que le potentiel calorifique ?",
    "options": [
      "Chaleur dégagée par la combustion totale des matériaux d’un local",
      "Exprimé en MJ/m²",
      "Identique pour tous les matériaux",
      "Température maximale d’un feu confiné",
      "Oxygène consommé par la combustion",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Chaleur dégagée par la combustion totale des matériaux d’un local",
      "Exprimé en MJ/m²"
    ]
  },
  {
    "question": "Quelles sont les conditions nécessaires à la combustion des gaz ?",
    "options": [
      "Énergie d’activation suffisante",
      "Concentration entre L.I.E et L.S.E",
      "Possible sans oxygène",
      "Indépendante de la température",
      "Se déclenche dès libération du gaz",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Énergie d’activation suffisante",
      "Concentration entre L.I.E et L.S.E"
    ]
  },
  {
    "question": "Quels matériaux sont concernés par les feux de classe A ?",
    "options": [
      "Matériaux solides : bois, carton, tissu, paille, papier",
      "Uniquement liquides inflammables",
      "Gaz inflammables : butane, propane",
      "Métaux combustibles",
      "Uniquement graisses alimentaires",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Matériaux solides : bois, carton, tissu, paille, papier"
    ]
  },
  {
    "question": "Quels matériaux sont concernés par les feux de classe B ?",
    "options": [
      "Liquides inflammables : essence, alcool, fioul, graisse, goudron",
      "Uniquement solides formant des braises",
      "Gaz inflammables",
      "Métaux combustibles",
      "Uniquement huiles de cuisson",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Liquides inflammables : essence, alcool, fioul, graisse, goudron"
    ]
  },
  {
    "question": "Quels matériaux sont concernés par les feux de classe C ?",
    "options": [
      "Gaz inflammables : hydrogène, acétylène, butane, propane",
      "Solides : bois, papier, carton",
      "Uniquement liquides inflammables",
      "Huiles et graisses alimentaires",
      "Métaux combustibles",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Gaz inflammables : hydrogène, acétylène, butane, propane"
    ]
  },
  {
    "question": "Quels matériaux sont concernés par les feux de classe D ?",
    "options": [
      "Métaux : sodium, aluminium, magnésium, potassium",
      "Uniquement solides organiques",
      "Liquides inflammables : essence, alcool",
      "Huiles et graisses alimentaires",
      "Uniquement gaz inflammables",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Métaux : sodium, aluminium, magnésium, potassium"
    ]
  },
  {
    "question": "Quels matériaux sont concernés par les feux de classe F ?",
    "options": [
      "Huiles et graisses alimentaires végétales et animales",
      "Matériaux solides : bois, carton",
      "Liquides inflammables : fioul, alcool",
      "Gaz inflammables : propane, hydrogène",
      "Métaux combustibles",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Huiles et graisses alimentaires végétales et animales"
    ]
  },
  {
    "question": "Quelle affirmation sur les classes de feux est correcte ?",
    "options": [
      "A, B et C concernent uniquement les solides",
      "D et F nécessitent des extincteurs spécifiques",
      "B implique des liquides inflammables",
      "C concerne uniquement les gaz",
      "F est lié aux auxiliaires de cuisson",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "B implique des liquides inflammables",
      "C concerne uniquement les gaz",
      "F est lié aux auxiliaires de cuisson"
    ]
  },
  {
    "question": "Quelle affirmation sur les classes de feux est incorrecte ?",
    "options": [
      "A concerne les solides formant des braises",
      "B concerne uniquement les solides",
      "C concerne les gaz et vapeurs inflammables",
      "D concerne les métaux : magnésium, sodium",
      "F implique les graisses et huiles alimentaires",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "B concerne uniquement les solides (incorrecte, B concerne les liquides inflammables)"
    ]
  },
  {
    "question": "Quelles sont les conditions nécessaires à la combustion des gaz ?",
    "options": [
      "Énergie d’activation suffisante",
      "Concentration entre L.I.E et L.S.E",
      "Possible sans oxygène",
      "Indépendante de la température",
      "Se déclenche dès libération du gaz",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Énergie d’activation suffisante",
      "Concentration entre L.I.E et L.S.E"
    ]
  },
  {
    "question": "Quelles sont les causes humaines d’incendie ?",
    "options": [
      "Flammes nues, travaux par points chauds",
      "Cigarettes",
      "Ignorance et imprudence",
      "Rayonnement solaire",
      "Installations électriques défectueuses",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Flammes nues, travaux par points chauds",
      "Cigarettes",
      "Ignorance et imprudence"
    ]
  },
  {
    "question": "Quelles sont les causes naturelles d’incendie ?",
    "options": [
      "Foudre",
      "Fermentation",
      "Combustion spontanée",
      "Actes de malveillance",
      "Gaz inflammables",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Foudre",
      "Fermentation",
      "Combustion spontanée"
    ]
  },
  {
    "question": "Quelles sont les causes techniques d’incendie ?",
    "options": [
      "Installations électriques et appareils électriques",
      "Appareils de chauffage et de cuisine",
      "Réactions chimiques incontrôlées",
      "Cigarettes",
      "Rayonnement solaire",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Installations électriques et appareils électriques",
      "Appareils de chauffage et de cuisine",
      "Réactions chimiques incontrôlées"
    ]
  },
  {
    "question": "Quels sont les effets des fumées sur les personnes ?",
    "options": [
      "Brûlures par inhalation",
      "Réduction de la visibilité",
      "Asphyxie",
      "Rayonnement solaire",
      "Inflammation des liquides inflammables",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Brûlures par inhalation",
      "Réduction de la visibilité",
      "Asphyxie"
    ]
  },
  {
    "question": "Quels gaz toxiques peuvent être présents dans les fumées ?",
    "options": [
      "Monoxyde de carbone (CO)",
      "Acide cyanhydrique (HCN)",
      "Ammoniac (NH₃)",
      "Oxygène pur",
      "Azote pur",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Monoxyde de carbone (CO)",
      "Acide cyanhydrique (HCN)",
      "Ammoniac (NH₃)"
    ]
  },
  {
    "question": "Pourquoi les fumées sont-elles dangereuses ?",
    "options": [
      "Diminution de la visibilité",
      "Exposition aux gaz toxiques",
      "Difficultés respiratoires",
      "Propagation rapide du feu",
      "Augmentation du taux d’oxygène",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Diminution de la visibilité",
      "Exposition aux gaz toxiques",
      "Difficultés respiratoires",
      "Propagation rapide du feu"
    ]
  },
  {
    "question": "Qu’est-ce que le rayonnement thermique ?",
    "options": [
      "Transfert de chaleur par ondes électromagnétiques",
      "Propagation de chaleur par déplacement d’air chaud",
      "Transmission de chaleur par contact direct",
      "Déplacement de gaz chauds dans l’air ambiant",
      "Transport de chaleur uniquement par les liquides",
      "Aucune des réponses"
    ],
    "correctAnswers": [
      "Transfert de chaleur par ondes électromagnétiques"
    ]
  }
];
// Fonction de mélange (shuffle) avec l'algorithme Fisher-Yates
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// Mélange des questions
shuffleArray(quizData);

    // Initialisation des variables du quiz
    let currentQuestion = 0;
    let score = 0;
    let isMuted = false;

    // Références aux éléments HTML
    const homeDiv = document.getElementById("home");
    const quizContainer = document.getElementById("quiz-container");
    const resultPage = document.getElementById("result-page");
    const questionCounterEl = document.getElementById("question-counter");
    const questionTextEl = document.getElementById("question-text");
    const optionsDiv = document.getElementById("options");
    const resultDiv = document.getElementById("result");
    const finalScoreEl = document.getElementById("final-score");
    const finalImage = document.getElementById("final-image");
    const totalQuestionsSpan = document.getElementById("total-questions");
    const totalQuestionsResult = document.getElementById("total-questions-result");

    const startBtn = document.getElementById("start-btn");
    const validateBtn = document.getElementById("validate-btn");
    const restartBtn = document.getElementById("restart-btn");
    const indexBtn = document.getElementById("index-btn");
    const muteBtn = document.getElementById("mute-btn");

    const checkboxSound = document.getElementById("checkbox-sound");
    const startSound = document.getElementById("start-sound");
    const correctSound = document.getElementById("correct-sound");
    const incorrectSound = document.getElementById("incorrect-sound");
    const incorrectSound2 = document.getElementById("incorrect-sound2");

    // Mise à jour du nombre total de questions
    totalQuestionsSpan.textContent = quizData.length;
    totalQuestionsResult.textContent = quizData.length;

    // Précharger certaines images GIF
    const preloadImages = ["images/ryu.gif", "images/ken.gif", "images/ryu2.gif", "images/ken2.gif"];
    preloadImages.forEach(src => {
      const img = new Image();
      img.src = src;
    });

    // Fonction de basculement du son
    function muteToggleHandler() {
      isMuted = !isMuted;
      [startSound, correctSound, incorrectSound, checkboxSound,
       incorrectSound2,
       document.getElementById("perfect-sound"),
       document.getElementById("imperfect-sound")
      ].forEach(audio => { audio.muted = isMuted; });
      if (isMuted) {
        this.src = "images/mute-on.gif";
        this.alt = "Son désactivé";
      } else {
        this.src = "images/mute-off.gif";
        this.alt = "Son activé";
      }
    }
    muteBtn.addEventListener("click", muteToggleHandler);
    document.addEventListener("DOMContentLoaded", function() {
      var muteImg = document.getElementById("mute-btn");
      if (muteImg && muteImg.src.indexOf(".gif") !== -1) {
        var newMuteImg = muteImg.cloneNode(true);
        newMuteImg.src = newMuteImg.src.split('?')[0] + '?t=' + new Date().getTime();
        muteImg.parentNode.replaceChild(newMuteImg, muteImg);
        newMuteImg.addEventListener("click", muteToggleHandler);
      }
    });

    // Démarrage du quiz
    startBtn.addEventListener("click", () => {
      if (screen.orientation && screen.orientation.lock) {
        screen.orientation.lock("portrait").catch(error => { console.log("Le verrouillage de l'orientation a échoué :", error); });
      }
      startSound.play();
      startBtn.style.boxShadow = "0 0 20px rgba(0, 255, 0, 1)";
      startBtn.style.animation = "blink 0.3s infinite ease-in-out";
      setTimeout(() => {
        startBtn.style.animation = "glow-green 1.5s infinite ease-in-out";
        homeDiv.style.display = "none";
        quizContainer.style.display = "block";
        currentQuestion = 0;
        score = 0;
        showQuestion();
      }, 1500);
    });

    // Affichage d'une question
    function showQuestion() {
      resultDiv.innerHTML = "";
      validateBtn.style.display = "block";
      const data = quizData[currentQuestion];
      questionCounterEl.textContent = `${currentQuestion + 1} / ${quizData.length}`;
      questionTextEl.textContent = data.question;
      optionsDiv.innerHTML = "";
      data.options.forEach((option, index) => {
        const div = document.createElement("div");
        div.className = "option";
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.value = option;
        checkbox.name = "option";
        checkbox.id = `option_${index}`;
        checkbox.addEventListener("click", () => { checkboxSound.currentTime = 0; checkboxSound.play(); });
        const label = document.createElement("label");
        label.htmlFor = `option_${index}`;
        label.textContent = option;
        div.appendChild(checkbox);
        div.appendChild(label);
        optionsDiv.appendChild(div);
      });
    }

    // Fonction de comparaison des tableaux (ordre sans importance)
    function arraysEqual(a, b) {
      if (a.length !== b.length) return false;
      const sortedA = a.slice().sort();
      const sortedB = b.slice().sort();
      return sortedA.every((val, index) => val === sortedB[index]);
    }

    // Traitement de la validation de la réponse
    validateBtn.addEventListener("click", () => {
      const data = quizData[currentQuestion];
      const selected = Array.from(document.querySelectorAll('input[name="option"]:checked')).map(el => el.value);
      if (selected.length === 0) { alert("Veuillez sélectionner au moins une réponse"); return; }
      const isCorrect = arraysEqual(selected, data.correctAnswers);
      validateBtn.style.display = "none";
      if (isCorrect) {
        score++;
        correctSound.currentTime = 0;
        correctSound.play();
        resultDiv.innerHTML = 
          `<div class="correct-container">
            <img src="images/ryu.gif" alt="Décoration gauche" class="decor-left">
            <img src="images/correct.png" alt="Bonne réponse" class="result-image correct">
            <img src="images/ken.gif" alt="Décoration droite" class="decor-right">
          </div>`;
        setTimeout(() => {
          currentQuestion++;
          if (currentQuestion < quizData.length) {
            showQuestion();
          } else {
            showResultPage();
          }
        }, 1000);
      } else {
        const selectedSound = (Math.random() < 0.5) ? incorrectSound : incorrectSound2;
        selectedSound.currentTime = 0;
        selectedSound.play();
        resultDiv.innerHTML = 
          `<div class="incorrect-container">
            <img src="images/ryu2.gif" alt="Décoration gauche" class="decor-leftX">
            <img src="images/incorrect.png" alt="Mauvaise réponse" class="result-image incorrect">
            <img src="images/ken2.gif" alt="Décoration droite" class="decor-rightX">
          </div>
          <div class="incorrect-answer-header">Réponse :</div>
          <div class="incorrect-answer-text">${data.correctAnswers.join(", ")}</div>`;
        setTimeout(() => {
          resultDiv.innerHTML = 
            `<button id="next-btn">Suivant</button>
            <div class="incorrect-answer-wrapper">
              <div class="incorrect-answer-header">Réponse :</div>
              <div class="incorrect-answer-text">${data.correctAnswers.join(", ")}</div>
            </div>`;
          document.getElementById("next-btn").addEventListener("click", () => {
            currentQuestion++;
            if (currentQuestion < quizData.length) {
              showQuestion();
            } else {
              showResultPage();
            }
          });
        }, 2500);
      }
    });

    // Affichage de la page finale
    function showResultPage() {
      quizContainer.style.display = "none";
      resultPage.style.display = "block";
      const resultHeader = document.getElementById("result-header");
      if (score === quizData.length) {
        restartBtn.style.animation = "borderGlowGreen 2s ease-in-out infinite";
        resultPage.style.backgroundImage = "url('images/wall.png')";
        resultHeader.src = "images/youwin.png";
        resultHeader.style.marginTop = "10px";
        resultHeader.classList.add("victory-animation");
        finalScoreEl.style.color = "#00ff1a";
        finalImage.classList.add("raised");
        finalImage.style.width = (window.innerWidth <= 480) ? "150px" : "190px";
        document.getElementById("perfect-sound").currentTime = 0;
        document.getElementById("perfect-sound").play();
      } else {
        restartBtn.style.animation = "borderGlow2 2s ease-in-out infinite";
        resultPage.style.background = "url('images/wall.png')";
        resultHeader.src = "images/tryagain.png";
        resultHeader.style.transform = "translateX(0)";
        resultHeader.style.marginTop = "10px";
        finalScoreEl.style.color = "red";
        resultHeader.classList.add("windmill-shake");
        finalImage.classList.remove("raised");
        finalImage.style.width = "190px";
        finalImage.style.transform = "";
        setInterval(() => {
          resultHeader.classList.remove("windmill-shake");
          void resultHeader.offsetWidth;
          resultHeader.classList.add("windmill-shake");
        }, 2800);
      }
      resultPage.style.backgroundSize = "cover";
      resultPage.style.backgroundPosition = "center";
      finalScoreEl.textContent = `Score : ${score} sur ${quizData.length}`;
      finalImage.src = (score === quizData.length)
        ? "images/perfect.gif"
        : ((Math.random() < 0.5) ? "images/lose1.gif" : "images/lose2.gif");
      
      if (finalImage.src.indexOf("lose1.gif") !== -1 && window.innerWidth <= 480) {
        finalImage.style.transform = "translateY(-10px)";
      } else {
        finalImage.style.transform = "";
      }
      
      if (score === quizData.length) {
        document.getElementById("perfect-sound").currentTime = 0;
        document.getElementById("perfect-sound").play();
      } else {
        document.getElementById("imperfect-sound").currentTime = 0;
        document.getElementById("imperfect-sound").play();
      }
    }

    restartBtn.addEventListener("click", () => { window.location.reload(); });

    document.addEventListener("DOMContentLoaded", function() {
      var decorImage = document.querySelector('.pikachu');
      if (decorImage) {
        var decorGifs = ["images/decor1.gif", "images/decor2.gif"];
        var randomIndex = Math.floor(Math.random() * decorGifs.length);
        var randomGif = decorGifs[randomIndex];
        decorImage.src = randomGif;
        decorImage.style.visibility = 'visible';
      }
    });

    document.addEventListener("DOMContentLoaded", function() {
      const audios = document.querySelectorAll("audio");
      audios.forEach(audio => {
        const initialVolume = audio.volume;
        audio.volume = 0;
        audio.play().then(() => {
          audio.pause();
          audio.currentTime = 0;
          audio.volume = initialVolume;
        }).catch(error => {
          console.error("Erreur lors du préchargement audio:", error);
          audio.volume = initialVolume;
        });
      });
    });

    document.addEventListener("DOMContentLoaded", function() {
      var decorImage = document.querySelector('.pikachu');
      if (decorImage) {
        var decorGifs = ["images/decor1.gif", "images/decor2.gif"];
        var randomIndex = Math.floor(Math.random() * decorGifs.length);
        var randomGif = decorGifs[randomIndex];
        decorImage.src = randomGif + '?t=' + new Date().getTime();
        decorImage.style.visibility = 'visible';
      }
    });
    
    /* Logique pour le bouton INDEX et le modal correspondant */
    const indexModal = document.getElementById("index-modal");
    const closeIndexModal = document.getElementById("close-index-modal");

    // Affiche le modal lorsque l'on clique sur INDEX
    indexBtn.addEventListener("click", () => {
      indexModal.style.display = "block";
    });

    // Ferme le modal lorsqu'on clique sur le bouton "Fermer"
    closeIndexModal.addEventListener("click", () => {
      indexModal.style.display = "none";
    });

    // Pour chaque bouton dans le modal, rediriger vers l'URL spécifiée
    const indexOptions = document.querySelectorAll("#index-modal .index-option");
    indexOptions.forEach(button => {
      button.addEventListener("click", () => {
        window.location.href = button.dataset.url;
      });
    });
document.addEventListener("DOMContentLoaded", function(){
  const homeIndexBtn = document.getElementById("home-index-btn");
  if(homeIndexBtn){
    homeIndexBtn.addEventListener("click", function(){
      indexModal.style.display = "block";
    });
  }
});
    window.addEventListener('beforeunload', function (e) {
  // Annule l'événement comme indiqué par la norme.
  e.preventDefault();
  // Chrome nécessite que returnValue soit défini.
  e.returnValue = '';
});

  </script>
</body>
</html>
