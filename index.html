validateBtn.addEventListener("click", () => {
  // Si le bouton affiche "Suivant", passer à la question suivante
  if (validateBtn.textContent === "Suivant") {
    currentQuestion++;
    if (currentQuestion < quizData.length) {
      showQuestion();
      validateBtn.style.display = "block";
    } else {
      showResultPage();
    }
    return; // On quitte le gestionnaire ici
  }

  const data = quizData[currentQuestion];
  const selected = Array.from(document.querySelectorAll('input[name="option"]:checked')).map(el => el.value);
  if (selected.length === 0) { 
    alert("Veuillez sélectionner au moins une réponse"); 
    return; 
  }
  const isCorrect = arraysEqual(selected, data.correctAnswers);
  validateBtn.style.display = "none";
  
  if (isCorrect) {
    score++;
    correctSound.currentTime = 0;
    correctSound.play();
    resultDiv.innerHTML = `
      <div class="correct-container">
        <img src="images/ryu.gif" alt="Décoration gauche" class="decor-left">
        <img src="images/correct.png" alt="Bonne réponse" class="result-image correct">
        <img src="images/ken.gif" alt="Décoration droite" class="decor-right">
      </div>
    `;
    // Pour une bonne réponse, on passe automatiquement à la question suivante après un délai
    const delayTime = 2000;
    setTimeout(() => {
      currentQuestion++;
      if (currentQuestion < quizData.length) {
        showQuestion();
        validateBtn.style.display = "block";
      } else {
        showResultPage();
      }
    }, delayTime);
  } else {
    const selectedSound = (Math.random() < 0.5) ? incorrectSound : incorrectSound2;
    selectedSound.currentTime = 0;
    selectedSound.play();
    resultDiv.innerHTML = `
      <div class="incorrect-container">
        <img src="images/ryu2.gif" alt="Décoration gauche" class="decor-leftX">
        <img src="images/incorrect.png" alt="Mauvaise réponse" class="result-image incorrect">
        <img src="images/ken2.gif" alt="Décoration droite" class="decor-rightX">
      </div>
      <div class="incorrect-answer-header">Réponse :</div>
      <div class="incorrect-answer-text">${data.correctAnswers.join(", ")}</div>
    `;
    // Changer le texte du bouton en "Suivant"
    validateBtn.textContent = "Suivant";
    // On n'appelle pas de setTimeout ici, on attend le clic de l'utilisateur
  }
});
